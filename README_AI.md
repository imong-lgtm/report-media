# REPORT MEDIA - Project Documentation for AI Agents

This document is designed to provide all technical context necessary for an AI assistant to take over maintenance and development of this project.

## üöÄ Project Overview
- **Project Name**: Report Media (Portal Berita Investigasi)
- **Framework**: Laravel 8 (PHP 8.2)
- **Styling**: Vanilla CSS / Tailwind (via Laravel Mix)
- **Deployment Platform**: Vercel
- **Database**: 
    - **Production**: Vercel Postgres (PostgreSQL)
    - **Local**: SQLite (`database/database.sqlite`)

## üõ†Ô∏è Critical Architecture & Persistence Strategy

### 1. Ephemeral Filesystem (Vercel)
Vercel has a read-only filesystem (except `/tmp`). Because of this, **standard Laravel local file storage (`storage/app/public`) WILL NOT WORK** for persistent uploads.

**Solution: Base64 Encoding**
- All images (Article thumbnails, Company Logos) are stored as **Base64 strings** directly in the database.
- Databases columns for images use `longText` to prevent truncation.
- **Rules for AI**: Do NOT attempt to use `Storage::disk('public')` or `php artisan storage:link`. Always encode to Base64 in controllers before saving.

### 2. Database Connection & Auto-Migration
The entry point for Vercel is `api/index.php`. This file contains critical logic:
- **Environment Detection**: Automatically detects `POSTGRES_URL` on Vercel and configures Laravel's database connection on-the-fly.
- **Auto-Migration**: Runs `php artisan migrate --force` automatically if certain tables are missing. This ensures the database stays up-to-date across rebuilds.
- **SSL**: Forces `sslmode=require` for Postgres connections.

### 3. Key Global Data
- `AppServiceProvider.php` uses `View::composer('*', ...)` to share `$categoriesWithArticles` and `$companyProfile` across all Blade views.
- Most branding (Name, Logo, Address, Social Media) is dynamic and managed via the **Company Profile** module.

## üìÇ Key File Map
| Path | Purpose |
| --- | --- |
| `api/index.php` | **The Most Critical File.** Handles Vercel boot, DB config, and Auto-migration. |
| `routes/web.php` | Main routing. Admin routes are prefixed with `/admin` and protected by middleware. |
| `app/Http/Controllers/Admin/` | Controllers for managing Articles, Categories, and Company Profile. |
| `app/Models/Article.php` | Article model. Uses `longText` for `image` attribute. |
| `resources/views/layouts/app.blade.php` | The main frontend layout (Header, Footer). |
| `resources/views/admin/profile/edit.blade.php` | The UI for managing company identity. |

## üîë Admin Credentials (Default)
- **URL**: `/login`
- **Email**: `admin@telco.id`
- **Password**: `password123`
*(Note: These are seeded automatically by `api/index.php` if the database is empty.)*

## üìù Tips for the Next Agent
1. **Always use the Browser Tool**: To verify changes on the live Vercel site since local storage/db might behave differently than Postgres.
2. **Handle Database Migrations Manually if needed**: If a new migration is added, ensure `api/index.php` logic will trigger it, or push and let the auto-migration run on the first request.
3. **Logo & Images**: When debugging image display, check if the `<img>` tag is trying to use `asset('storage/...')`. If it is, change it to use the raw Base64 string from the database.
4. **Environment Variables**: For deployment, ensure `POSTGRES_URL`, `APP_KEY`, and `APP_ENV=production` are set in the Vercel Dashboard.

---
*Documentation generated by Antigravity AI on 2026-02-26.*
